<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>using Python's subprocess module - Tshepang logs</title>
        <script>if (top !== self) top.location = self.location;</script>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0" />
        <link rel="stylesheet" href="/static/style.css?v=709a5" />
        <link rel="stylesheet" href="/static/pygments.css?v=c6adc" />
        
        <link rel="alternate" type="application/rss+xml" href="/feed" title="Tshepang logs" />
        <!--[if lt IE 9]>
        <script type="text/javascript" src="/static/html5shiv.js?v=9a10c"></script>
        <![endif]-->
        <script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-16685250-3']);
            _gaq.push(['_trackPageview']);
            _gaq.push(['_trackPageLoadTime']);
            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
        
<link rel="canonical" href="/using-pythons-subprocess-module" />


    </head>
    <body>
        <header id="header">
            <h1 id="brand"><a href="/">Tshepang logs</a></h1>
            <nav id="nav" role="navigation">
                
                <a href="/misc/">misc</a>
                <a href="/computing/">computing</a>
                <a href="/arts/">arts</a>
                <a href="/key-posts">| key-posts |</a>
                <a href="/about-me">| about-me |</a>
            </nav>
        </header>

        <div id="main">
            <div class="container"><div class="hentry">
    <h1 class="entry-title">using Python's subprocess module</h1>
    <div class="entry-meta">
        <time class="updated" datetime="2011-01-26T00:00:00+02:00" pubdate>
            <a href="/2011/">2011-01-26</a>
        </time>
        <span class="author vcard">
            by <span class="fn">Tshepang Lekhonkhobe</span>
        </span>
    </div>
    <div class="entry-content">
        <p>There are at least 2 ways to run a simple command like <tt class="docutils literal">echo test</tt> in
Python: via the shell, or directly (via the kernel).</p>
<p>This is via the shell:</p>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">subprocess</span>
<span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="s">&quot;echo test&quot;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
<p>Output:</p>
<pre class="literal-block">
test
</pre>
<p>This is via the kernel:</p>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">subprocess</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s">&quot;echo&quot;</span><span class="p">,</span> <span class="s">&quot;test&quot;</span><span class="p">],</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>
<p>Output:</p>
<pre class="literal-block">
(b'testn', b'')
</pre>
<p>Not exactly what we want. The output is actually a tuple (<strong>stdout</strong>,
<strong>stderr</strong>). Note that by default, <tt class="docutils literal">shell=False</tt>, and that's why it's
not stated here.</p>
<p>To get the equivalent of what we get from the first example, we have to
do a bit more work:</p>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">subprocess</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s">&quot;echo&quot;</span><span class="p">,</span> <span class="s">&quot;test&quot;</span><span class="p">],</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(),</span> <span class="n">end</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
</pre></div>
<p>Output:</p>
<pre class="literal-block">
test
</pre>
<p>The <tt class="docutils literal">b</tt> thing indicates that the string is in bytes format. To get a
normal string from that, just run the string's <a class="reference external" href="http://docs.python.org/library/stdtypes.html?highlight=encode#str.decode">decode method</a>. Also,
that I had to use the <tt class="docutils literal">end</tt> argument on the <a class="reference external" href="http://docs.python.org/library/functions.html#print">print function</a>, was to
avoid an empty line on the terminal output.</p>
<p>As can be seen, this means we do much of the work ourself, but the
benefit is that we now have finer-grained control (e.g. we get to
control when to display the output). Another benefit is that it is more
secure to do it this way (I don't know the details, so see <a class="reference external" href="http://en.wikipedia.org/wiki/Shell_injection#Shell_injection">shell
injection</a> for the argument).</p>
<div class="section" id="further-reading">
<h2>further reading</h2>
<ul class="simple">
<li>There is a whole wealth of info on this from <a class="reference external" href="http://jimmyg.org/blog/2009/working-with-python-subprocess.html">a gentle tutorial</a>
where I learned this stuff. It also explains what pipes are
(<tt class="docutils literal">subprocess.PIPE</tt>)</li>
<li>Also, take a look at <a class="reference external" href="http://docs.python.org/library/subprocess.html#subprocess.Popen.communicate">the official doc for the Popen.communicate()
method</a></li>
<li><a class="reference external" href="http://diveintopython3.net/strings.html">a great explanation</a> of what strings really are, and how they
relate to Python 3</li>
</ul>
</div>

    </div>

    

    <div class="entry-tags">
        <a href="/tag/#Python">Python</a>
    </div>

    <iframe style="border: 0; margin: 0; padding: 0;"
        src="https://www.gittip.com/tshepang/widget.html"
        width="48pt" height="22pt"></iframe>

    
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'tshepanglogs';
        var disqus_title = 'using Python's subprocess module';
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    
</div></div>
        </div>

        <footer id="footer">
            <hr class="end" />
            
            <p class="copyright">
            <span class="software">
                Powered by <a href="http://lab.lepture.com/liquidluck/">Felix Felicis</a> 3.8,
            </span>
            <span class="theme">
                Theme <a href="https://github.com/lepture/liquidluck-theme-moment" rel="nofollow">moment</a> 1.0 by <a href="http://lepture.com">Hsiaoming Yang</a>
            </span>
            </p>
        </footer>
        <script type="text/javascript" src="/static/mobile.js?v=3b6df"></script>
        
    </body>
</html>